{"version":3,"file":"approvedcomments.element-D-X28bSs.js","sources":["../../../assets/src/workspaces/views/approvedcomments.element.ts"],"sourcesContent":["import { UmbElementMixin } from '@umbraco-cms/backoffice/element-api';\r\nimport { LitElement, html, css, customElement, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { CommentSchema } from '../../api';\r\nimport { COMMENTS_CONTEXT, CommentsContext } from '../../contexts/comments.context';\r\nimport { UMB_WORKSPACE_CONTEXT } from '@umbraco-cms/backoffice/workspace';\r\nimport { UmbDocumentWorkspaceContext } from '@umbraco-cms/backoffice/document';\r\nimport { UMB_CONFIRM_MODAL, UMB_MODAL_MANAGER_CONTEXT, UmbModalManagerContext } from '@umbraco-cms/backoffice/modal';\r\nimport { UMB_NOTIFICATION_CONTEXT, UmbNotificationContext, UmbNotificationDefaultData } from '@umbraco-cms/backoffice/notification';\r\n\r\n@customElement('approvedcomments-workspace-view')\r\nexport class ApprovedCommentsWorkspaceElement extends UmbElementMixin(LitElement) {\r\n    #commentsContext?: CommentsContext;\r\n    #umbracoContext?: UmbDocumentWorkspaceContext;\r\n    #modalContext?: UmbModalManagerContext;\r\n    #notificationContext?: UmbNotificationContext;\r\n\r\n    @property()\r\n    title = \"Approved comments\"\r\n\r\n    @state()\r\n    comments?: CommentSchema[];\r\n\r\n    @property()\r\n    nodeId?: string;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.consumeContext(COMMENTS_CONTEXT, (_instance) => {\r\n            this.#commentsContext = _instance;\r\n\r\n            this.observe(_instance.approvedComments, (_comments: CommentSchema[]) => {\r\n                this.comments = _comments\r\n            });\r\n        });\r\n\r\n        this.consumeContext(UMB_WORKSPACE_CONTEXT, (_instance) => {\r\n            this.#umbracoContext = _instance as UmbDocumentWorkspaceContext;\r\n\r\n            this.#umbracoContext.unique.subscribe((value: string) => {\r\n                this.nodeId = value;\r\n            })\r\n        });\r\n\r\n        this.consumeContext(UMB_MODAL_MANAGER_CONTEXT, (_instance) => {\r\n            this.#modalContext = _instance;\r\n        });\r\n\r\n        this.consumeContext(UMB_NOTIFICATION_CONTEXT, (_instance) => {\r\n            this.#notificationContext = _instance;\r\n        });\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        super.connectedCallback();\r\n\r\n        if (this.#commentsContext != null) {\r\n            this.getApprovedComments();\r\n        }\r\n    }\r\n\r\n    async getApprovedComments() {\r\n        if (this.nodeId !== undefined)\r\n        {\r\n            await this.#commentsContext?.getApprovedComments(this.nodeId);\r\n        }\r\n    }\r\n    \r\n    #onClickTrash = (comment: CommentSchema) => async (): Promise<void> => {\r\n        const modalHandler = this.#modalContext?.open(this, UMB_CONFIRM_MODAL, {\r\n            data: {\r\n                headline: `Trash`,\r\n                content: 'Are you sure you want to move the comment to the Discussions Recycle Bin?',\r\n                confirmLabel: 'Trash',\r\n                color: 'danger'\r\n            }\r\n        });\r\n\r\n        modalHandler?.onSubmit().then(async () => {\r\n            await this.#commentsContext?.trashComment(comment.id);\r\n            await this.getApprovedComments();\r\n\r\n            const data: UmbNotificationDefaultData = {\r\n                headline: `Trashed`,\r\n                message: `The comment has been moved to the Discussions Recycle Bin.`\r\n            };\r\n            await this.#notificationContext?.peek(\"positive\", { data });\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return html`\r\n            <umb-body-layout>\r\n                <div class=\"comments\">\r\n                    ${this.comments?.map((comment) => {\r\n                        return html`\r\n                            <uui-box>\r\n                                <div slot=\"headline\">${comment.author}</div>\r\n                                <div slot=\"header\">${comment.date}</div>\r\n                                <div slot=\"header-actions\">\r\n                                    <uui-button pristine label=\"Delete\" look=\"primary\" color=\"danger\" @click=${this.#onClickTrash(comment)}>\r\n                                        <uui-icon name=\"delete\"></uui-icon>\r\n                                    </uui-button>\r\n                                </div>\r\n                                <div class=\"comment\">\r\n                                    <p class=\"comment__message\">${comment.message}</p>\r\n                                </div>\r\n                            </uui-box>\r\n                        `\r\n                    })}\r\n                </div>\r\n            </umb-body-layout>\r\n        `\r\n    }\r\n\r\n    static override styles = [\r\n        css`\r\n            .comments {\r\n                display: grid;\r\n                grid-gap: 2rem;\r\n                grid-template-columns: repeat(3, 1fr);\r\n            }\r\n\r\n            .comment {\r\n                display: flex;\r\n                gap: 3rem;\r\n                flex-direction: column;\r\n            }\r\n\r\n            .comment__message {\r\n                margin: 0;\r\n            }\r\n        `\r\n    ];\r\n}\r\n\r\nexport default ApprovedCommentsWorkspaceElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'approvedcomments-workspace-view': ApprovedCommentsWorkspaceElement\r\n\t}\r\n}"],"names":["_commentsContext","_umbracoContext","_modalContext","_notificationContext","_onClickTrash","ApprovedCommentsWorkspaceElement","UmbElementMixin","LitElement","__privateAdd","comment","modalHandler","_a","__privateGet","UMB_CONFIRM_MODAL","data","_b","COMMENTS_CONTEXT","_instance","__privateSet","_comments","UMB_WORKSPACE_CONTEXT","value","UMB_MODAL_MANAGER_CONTEXT","UMB_NOTIFICATION_CONTEXT","html","css","__decorateClass","property","state","customElement","ApprovedCommentsWorkspaceElement$1"],"mappings":"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"}